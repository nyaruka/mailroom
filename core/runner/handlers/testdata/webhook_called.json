[
    {
        "label": "#1",
        "actions": {
            "a393abc0-283d-4c9b-a1b3-641a035c34bf": [
                {
                    "type": "call_resthook",
                    "uuid": "9fa3f6f9-556c-4262-aabb-0499580a767d",
                    "resthook": "foo",
                    "result_name": "foo"
                }
            ],
            "cd024bcd-f473-4719-a00a-bd0bb1190135": [
                {
                    "type": "call_resthook",
                    "uuid": "3efc9d08-dba4-41aa-9c9b-205423af1be7",
                    "resthook": "foo",
                    "result_name": "foo"
                },
                {
                    "type": "call_webhook",
                    "uuid": "0994c577-1f8e-4590-bf61-4d56af0a56a4",
                    "method": "GET",
                    "url": "http://rapidpro.io/?unsub=1"
                }
            ]
        },
        "db_assertions": [
            {
                "query": "select count(*) from api_resthooksubscriber where is_active = FALSE",
                "returns": 1
            },
            {
                "query": "select count(*) from api_resthooksubscriber where is_active = TRUE and resthook_id = 30001",
                "returns": 1
            },
            {
                "query": "select count(*) from api_resthooksubscriber where is_active = TRUE",
                "returns": 2
            },
            {
                "query": "select count(*) from request_logs_httplog where log_type = 'webhook_called' AND flow_id IS NOT NULL AND status_code = 200",
                "returns": 2
            },
            {
                "query": "select count(*) from request_logs_httplog where log_type = 'webhook_called' AND flow_id IS NOT NULL AND status_code = 410",
                "returns": 3
            },
            {
                "query": "select count(*) from api_webhookevent where org_id = $1",
                "args": [
                    1
                ],
                "returns": 2
            }
        ],
        "expected_history": [
            {
                "PK": "con#b699a406-7e44-49be-9f01-1a82893e8a10",
                "SK": "evt#01969b47-8a53-76f8-bef6-3979f99a96f9",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:31:20.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b47-866b-76f8-9014-2c868db4022e",
                    "type": "run_started"
                }
            },
            {
                "PK": "con#b699a406-7e44-49be-9f01-1a82893e8a10",
                "SK": "evt#01969b47-99f3-76f8-be24-6164105d48f2",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:31:24.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b47-866b-76f8-9014-2c868db4022e",
                    "status": "completed",
                    "type": "run_ended"
                }
            },
            {
                "PK": "con#d709c157-4606-4d41-9df3-9e9c9b4ae2d4",
                "SK": "evt#01969b48-3e03-76f8-8ceb-17799a976525",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:32:06.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b48-3a1b-76f8-a5ef-59cf4d9d7a5b",
                    "type": "run_started"
                }
            },
            {
                "PK": "con#d709c157-4606-4d41-9df3-9e9c9b4ae2d4",
                "SK": "evt#01969b48-4da3-76f8-998e-ae5bd773804a",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:32:10.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b48-3a1b-76f8-a5ef-59cf4d9d7a5b",
                    "status": "completed",
                    "type": "run_ended"
                }
            },
            {
                "PK": "con#cd024bcd-f473-4719-a00a-bd0bb1190135",
                "SK": "evt#01969b47-bd1b-76f8-a8fd-1537ca860f97",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:31:33.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b47-b933-76f8-9566-6fb2598c32d6",
                    "type": "run_started"
                }
            },
            {
                "PK": "con#cd024bcd-f473-4719-a00a-bd0bb1190135",
                "SK": "evt#01969b48-1adb-76f8-8631-f6b52b12c734",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:31:57.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b47-b933-76f8-9566-6fb2598c32d6",
                    "status": "completed",
                    "type": "run_ended"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-190b-76f8-b62c-3c781ca3b5da",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:30:51.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b47-1523-76f8-8e78-3bde7b3370ae",
                    "type": "run_started"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-672b-76f8-ba82-c15b24dd577f",
                "OrgID": 1,
                "Data": {
                    "created_on": "2025-05-04T12:31:11.123456789Z",
                    "flow": {
                        "name": "Test Flow",
                        "revision": 1,
                        "uuid": "9de3663f-c5c5-4c92-9f45-ecbc09abcc85"
                    },
                    "run_uuid": "01969b47-1523-76f8-8e78-3bde7b3370ae",
                    "status": "completed",
                    "type": "run_ended"
                }
            }
        ]
    }
]