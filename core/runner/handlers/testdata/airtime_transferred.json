[
    {
        "label": "#1",
        "events": {
            "a393abc0-283d-4c9b-a1b3-641a035c34bf": [
                {
                    "uuid": "01969b47-47eb-76f8-8e78-3bde7b3370ae",
                    "type": "airtime_transferred",
                    "created_on": "2025-05-04T12:31:03.123456789Z",
                    "step_uuid": "688e64f9-2456-4b42-afcb-91a2073e5459",
                    "external_id": "2237512891",
                    "sender": "tel:+13605551212",
                    "recipient": "tel:+16055741111",
                    "currency": "USD",
                    "amount": 3,
                    "http_logs": [
                        {
                            "url": "https://dvs-api.dtone.com/v1/lookup/mobile-number",
                            "status_code": 200,
                            "request": "POST /v1/lookup/mobile-number HTTP/1.1\r\nHost: dvs-api.dtone.com\r\nUser-Agent: Go-http-client/1.1\r\nContent-Length: 32\r\nAuthorization: Basic a2V5MTIzOnNlc2FtZQ==\r\nContent-Type: application/json\r\nAccept-Encoding: gzip\r\n\r\n{\"mobile_number\":\"+16055741111\"}",
                            "response": "HTTP/1.0 200 OK\r\nContent-Length: 337\r\n\r\n[\n\t{\n\t\t\"country\": {\n\t\t\"iso_code\": \"ECU\",\n\t\t\"name\": \"Ecuador\",\n\t\t\"regions\": null\n\t\t},\n\t\t\"id\": 1596,\n\t\t\"identified\": true,\n\t\t\"name\": \"Claro Ecuador\",\n\t\t\"regions\": null\n\t},\n\t{\n\t\t\"country\": {\n\t\t\"iso_code\": \"ECU\",\n\t\t\"name\": \"Ecuador\",\n\t\t\"regions\": null\n\t\t},\n\t\t\"id\": 1597,\n\t\t\"identified\": false,\n\t\t\"name\": \"CNT Ecuador\",\n\t\t\"regions\": null\n\t}\n]",
                            "elapsed_ms": 1000,
                            "retries": 0,
                            "status": "success",
                            "created_on": "2025-05-04T12:30:55.123456789Z"
                        },
                        {
                            "url": "https://dvs-api.dtone.com/v1/products?type=FIXED_VALUE_RECHARGE&operator_id=1596&per_page=100",
                            "status_code": 200,
                            "request": "GET /v1/products?type=FIXED_VALUE_RECHARGE&operator_id=1596&per_page=100 HTTP/1.1\r\nHost: dvs-api.dtone.com\r\nUser-Agent: Go-http-client/1.1\r\nAuthorization: Basic a2V5MTIzOnNlc2FtZQ==\r\nAccept-Encoding: gzip\r\n\r\n",
                            "response": "HTTP/1.0 200 OK\r\nContent-Length: 2686\r\n\r\n[\n\t{\n\t\t\"availability_zones\": [\n\t\t\t\"INTERNATIONAL\"\n\t\t],\n\t\t\"benefits\": [\n\t\t\t{\n\t\t\t\"additional_information\": null,\n\t\t\t\"amount\": {\n\t\t\t\t\"base\": 3,\n\t\t\t\t\"promotion_bonus\": 0,\n\t\t\t\t\"total_excluding_tax\": 3\n\t\t\t},\n\t\t\t\"type\": \"CREDITS\",\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t\t}\n\t\t],\n\t\t\"description\": \"\",\n\t\t\"destination\": {\n\t\t\t\"amount\": 3,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t},\n\t\t\"id\": 6035,\n\t\t\"name\": \"3 USD\",\n\t\t\"operator\": {\n\t\t\t\"country\": {\n\t\t\t\"iso_code\": \"ECU\",\n\t\t\t\"name\": \"Ecuador\",\n\t\t\t\"regions\": null\n\t\t\t},\n\t\t\t\"id\": 1596,\n\t\t\t\"name\": \"Claro Ecuador\",\n\t\t\t\"regions\": null\n\t\t},\n\t\t\"prices\": {\n\t\t\t\"retail\": {\n\t\t\t\"amount\": 4,\n\t\t\t\"fee\": 0,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t\t},\n\t\t\t\"wholesale\": {\n\t\t\t\"amount\": 3.6,\n\t\t\t\"fee\": 0,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t\t}\n\t\t},\n\t\t\"promotions\": null,\n\t\t\"rates\": {\n\t\t\t\"base\": 0.833333333333333,\n\t\t\t\"retail\": 0.75,\n\t\t\t\"wholesale\": 0.833333333333333\n\t\t},\n\t\t\"regions\": null,\n\t\t\"required_beneficiary_fields\": null,\n\t\t\"required_credit_party_identifier_fields\": [\n\t\t\t[\n\t\t\t\"mobile_number\"\n\t\t\t]\n\t\t],\n\t\t\"required_debit_party_identifier_fields\": null,\n\t\t\"required_sender_fields\": null,\n\t\t\"service\": {\n\t\t\t\"id\": 1,\n\t\t\t\"name\": \"Mobile\"\n\t\t},\n\t\t\"source\": {\n\t\t\t\"amount\": 3.6,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t},\n\t\t\"type\": \"FIXED_VALUE_RECHARGE\",\n\t\t\"validity\": null\n\t\t},\n\t\t{\n\t\t\"availability_zones\": [\n\t\t\t\"INTERNATIONAL\"\n\t\t],\n\t\t\"benefits\": [\n\t\t\t{\n\t\t\t\"additional_information\": null,\n\t\t\t\"amount\": {\n\t\t\t\t\"base\": 6,\n\t\t\t\t\"promotion_bonus\": 0,\n\t\t\t\t\"total_excluding_tax\": 6\n\t\t\t},\n\t\t\t\"type\": \"CREDITS\",\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t\t}\n\t\t],\n\t\t\"description\": \"\",\n\t\t\"destination\": {\n\t\t\t\"amount\": 6,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t},\n\t\t\"id\": 6036,\n\t\t\"name\": \"6 USD\",\n\t\t\"operator\": {\n\t\t\t\"country\": {\n\t\t\t\"iso_code\": \"ECU\",\n\t\t\t\"name\": \"Ecuador\",\n\t\t\t\"regions\": null\n\t\t\t},\n\t\t\t\"id\": 1596,\n\t\t\t\"name\": \"Claro Ecuador\",\n\t\t\t\"regions\": null\n\t\t},\n\t\t\"prices\": {\n\t\t\t\"retail\": {\n\t\t\t\"amount\": 7,\n\t\t\t\"fee\": 0,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t\t},\n\t\t\t\"wholesale\": {\n\t\t\t\"amount\": 6.3,\n\t\t\t\"fee\": 0,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t\t}\n\t\t},\n\t\t\"promotions\": null,\n\t\t\"rates\": {\n\t\t\t\"base\": 0.952380952380952,\n\t\t\t\"retail\": 0.857142857142857,\n\t\t\t\"wholesale\": 0.952380952380952\n\t\t},\n\t\t\"regions\": null,\n\t\t\"required_beneficiary_fields\": null,\n\t\t\"required_credit_party_identifier_fields\": [\n\t\t\t[\n\t\t\t\t\"mobile_number\"\n\t\t\t]\n\t\t],\n\t\t\"required_debit_party_identifier_fields\": null,\n\t\t\"required_sender_fields\": null,\n\t\t\"service\": {\n\t\t\t\"id\": 1,\n\t\t\t\"name\": \"Mobile\"\n\t\t},\n\t\t\"source\": {\n\t\t\t\"amount\": 6.3,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t},\n\t\t\"type\": \"FIXED_VALUE_RECHARGE\",\n\t\t\"validity\": null\n\t}\n]",
                            "elapsed_ms": 1000,
                            "retries": 0,
                            "status": "success",
                            "created_on": "2025-05-04T12:30:57.123456789Z"
                        },
                        {
                            "url": "https://dvs-api.dtone.com/v1/async/transactions",
                            "status_code": 200,
                            "request": "POST /v1/async/transactions HTTP/1.1\r\nHost: dvs-api.dtone.com\r\nUser-Agent: Go-http-client/1.1\r\nContent-Length: 151\r\nAuthorization: Basic a2V5MTIzOnNlc2FtZQ==\r\nContent-Type: application/json\r\nAccept-Encoding: gzip\r\n\r\n{\"external_id\":\"01969b47-3c33-76f8-9654-8a7258fbaae4\",\"product_id\":6035,\"auto_confirm\":true,\"credit_party_identifier\":{\"mobile_number\":\"+16055741111\"}}",
                            "response": "HTTP/1.0 200 OK\r\nContent-Length: 1296\r\n\r\n{\n\t\"benefits\": [\n\t\t{\n\t\t\t\"additional_information\": null,\n\t\t\t\"amount\": {\n\t\t\t\t\"base\": 3,\n\t\t\t\t\"promotion_bonus\": 0,\n\t\t\t\t\"total_excluding_tax\": 3\n\t\t\t},\n\t\t\t\"type\": \"CREDITS\",\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t}\n\t],\n\t\"confirmation_date\": \"2021-03-24T20:05:06.111631000Z\",\n\t\"confirmation_expiration_date\": \"2021-03-24T21:05:05.883561000Z\",\n\t\"creation_date\": \"2021-03-24T20:05:05.883561000Z\",\n\t\"credit_party_identifier\": {\n\t\t\"mobile_number\": \"+593979123456\"\n\t},\n\t\"external_id\": \"EX12345\",\n\t\"id\": 2237512891,\n\t\"prices\": {\n\t\t\"retail\": {\n\t\t\t\"amount\": 4,\n\t\t\t\"fee\": 0,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t},\n\t\t\"wholesale\": {\n\t\t\t\"amount\": 3.6,\n\t\t\t\"fee\": 0,\n\t\t\t\"unit\": \"USD\",\n\t\t\t\"unit_type\": \"CURRENCY\"\n\t\t}\n\t},\n\t\"product\": {\n\t\t\"description\": \"\",\n\t\t\"id\": 6035,\n\t\t\"name\": \"3 USD\",\n\t\t\"operator\": {\n\t\t\t\"country\": {\n\t\t\t\t\"iso_code\": \"ECU\",\n\t\t\t\t\"name\": \"Ecuador\",\n\t\t\t\t\"regions\": null\n\t\t\t},\n\t\t\t\"id\": 1596,\n\t\t\t\"name\": \"Claro Ecuador\",\n\t\t\t\"regions\": null\n\t\t},\n\t\t\"regions\": null,\n\t\t\"service\": {\n\t\t\t\"id\": 1,\n\t\t\t\"name\": \"Mobile\"\n\t\t},\n\t\t\"type\": \"FIXED_VALUE_RECHARGE\"\n\t},\n\t\"promotions\": null,\n\t\"rates\": {\n\t\t\"base\": 0.833333333333333,\n\t\t\"retail\": 0.75,\n\t\t\"wholesale\": 0.833333333333333\n\t},\n\t\"status\": {\n\t\t\"class\": {\n\t\t\t\"id\": 2,\n\t\t\t\"message\": \"CONFIRMED\"\n\t\t},\n\t\t\"id\": 20000,\n\t\t\"message\": \"CONFIRMED\"\n\t}\n}",
                            "elapsed_ms": 1000,
                            "retries": 0,
                            "status": "success",
                            "created_on": "2025-05-04T12:31:00.123456789Z"
                        }
                    ]
                }
            ]
        },
        "db_assertions": [
            {
                "query": "select count(*) from airtime_airtimetransfer where org_id = $1 AND contact_id = $2 AND status = 'S'",
                "args": [
                    1,
                    10000
                ],
                "returns": 1
            },
            {
                "query": "select count(*) from request_logs_httplog where org_id = $1 AND airtime_transfer_id IS NOT NULL AND is_error = FALSE AND url LIKE 'https://dvs-api.dtone.com/v1/%'",
                "args": [
                    1
                ],
                "returns": 3
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-47eb-76f8-8e78-3bde7b3370ae",
                "OrgID": 1,
                "Data": {
                    "type": "airtime_transferred"
                },
                "DataGZ": "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"
            }
        ]
    },
    {
        "label": "#2",
        "events": {
            "cd024bcd-f473-4719-a00a-bd0bb1190135": [
                {
                    "uuid": "01969b48-900b-76f8-a2d8-44b4f9caf25c",
                    "type": "airtime_transferred",
                    "created_on": "2025-05-04T12:32:27.123456789Z",
                    "step_uuid": "c174a241-6057-41a3-874b-f17fb8365c22",
                    "external_id": "",
                    "sender": "tel:+13605551212",
                    "recipient": "tel:+16055743333",
                    "currency": "",
                    "amount": 0,
                    "http_logs": [
                        {
                            "url": "https://dvs-api.dtone.com/v1/lookup/mobile-number",
                            "request": "POST /v1/lookup/mobile-number HTTP/1.1\r\nHost: dvs-api.dtone.com\r\nUser-Agent: Go-http-client/1.1\r\nContent-Length: 32\r\nAuthorization: Basic a2V5MTIzOnNlc2FtZQ==\r\nContent-Type: application/json\r\nAccept-Encoding: gzip\r\n\r\n{\"mobile_number\":\"+16055743333\"}",
                            "elapsed_ms": 1000,
                            "retries": 0,
                            "status": "connection_error",
                            "created_on": "2025-05-04T12:32:24.123456789Z"
                        }
                    ]
                },
                {
                    "uuid": "01969b48-97db-76f8-881a-ef06948e0f99",
                    "type": "error",
                    "created_on": "2025-05-04T12:32:29.123456789Z",
                    "step_uuid": "c174a241-6057-41a3-874b-f17fb8365c22",
                    "text": "number lookup failed: unable to connect to server"
                }
            ]
        },
        "db_assertions": [
            {
                "query": "select count(*) from airtime_airtimetransfer where org_id = $1 AND contact_id = $2 AND status = 'F'",
                "args": [
                    1,
                    10002
                ],
                "returns": 0
            },
            {
                "query": "select count(*) from request_logs_httplog where org_id = $1 AND airtime_transfer_id IS NOT NULL AND is_error = TRUE AND url LIKE 'https://dvs-api.dtone.com/v1/%'",
                "args": [
                    1
                ],
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#cd024bcd-f473-4719-a00a-bd0bb1190135",
                "SK": "evt#01969b48-900b-76f8-a2d8-44b4f9caf25c",
                "OrgID": 1,
                "Data": {
                    "amount": 0,
                    "created_on": "2025-05-04T12:32:27.123456789Z",
                    "currency": "",
                    "external_id": "",
                    "http_logs": [
                        {
                            "created_on": "2025-05-04T12:32:24.123456789Z",
                            "elapsed_ms": 1000,
                            "request": "POST /v1/lookup/mobile-number HTTP/1.1\r\nHost: dvs-api.dtone.com\r\nUser-Agent: Go-http-client/1.1\r\nContent-Length: 32\r\nAuthorization: Basic a2V5MTIzOnNlc2FtZQ==\r\nContent-Type: application/json\r\nAccept-Encoding: gzip\r\n\r\n{\"mobile_number\":\"+16055743333\"}",
                            "retries": 0,
                            "status": "connection_error",
                            "url": "https://dvs-api.dtone.com/v1/lookup/mobile-number"
                        }
                    ],
                    "recipient": "tel:+16055743333",
                    "sender": "tel:+13605551212",
                    "type": "airtime_transferred"
                }
            }
        ]
    }
]