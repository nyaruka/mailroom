[
    {
        "label": "noop",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": []
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "name": "Ann",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": []
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT name FROM contacts_contact WHERE id = 10000",
                "returns": "Ann"
            }
        ]
    },
    {
        "label": "set name",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 1,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "name",
                    "name": "Kathy"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "name": "Kathy",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-0583-76f8-ae7f-f8b243c49ff5",
                            "type": "contact_name_changed",
                            "created_on": "2025-05-04T12:30:46.123456789Z",
                            "name": "Kathy"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT name FROM contacts_contact WHERE id = 10000",
                "returns": "Kathy"
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-0583-76f8-ae7f-f8b243c49ff5",
                "OrgID": 1,
                "TTL": "2026-05-04T12:30:46Z",
                "Data": {
                    "created_on": "2025-05-04T12:30:46.123456789Z",
                    "name": "Kathy",
                    "type": "contact_name_changed"
                }
            }
        ]
    },
    {
        "label": "set name",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "name",
                    "name": "Nate"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "name": "Nate",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-0d53-76f8-bd38-d266ec8d3716",
                            "type": "contact_name_changed",
                            "created_on": "2025-05-04T12:30:48.123456789Z",
                            "name": "Nate"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT name FROM contacts_contact WHERE id = 10000",
                "returns": "Nate"
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-0d53-76f8-bd38-d266ec8d3716",
                "OrgID": 1,
                "TTL": "2026-05-04T12:30:48Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:30:48.123456789Z",
                    "name": "Nate",
                    "type": "contact_name_changed"
                }
            }
        ]
    },
    {
        "label": "clear name",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "name",
                    "name": ""
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-1523-76f8-9c0b-2014ddc77094",
                            "type": "contact_name_changed",
                            "created_on": "2025-05-04T12:30:50.123456789Z",
                            "name": ""
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND name IS NULL",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-1523-76f8-9c0b-2014ddc77094",
                "OrgID": 1,
                "TTL": "2026-05-04T12:30:50Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:30:50.123456789Z",
                    "name": "",
                    "type": "contact_name_changed"
                }
            }
        ]
    },
    {
        "label": "set status to blocked",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "status",
                    "status": "blocked"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "blocked",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-1cf3-76f8-92a3-d648ab64bccb",
                            "type": "contact_status_changed",
                            "created_on": "2025-05-04T12:30:52.123456789Z",
                            "status": "blocked"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND status = 'B'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-1cf3-76f8-92a3-d648ab64bccb",
                "OrgID": 1,
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:30:52.123456789Z",
                    "status": "blocked",
                    "type": "contact_status_changed"
                }
            }
        ]
    },
    {
        "label": "set status to archived",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "status",
                    "status": "archived"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "archived",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-24c3-76f8-8228-9728778b6c98",
                            "type": "contact_status_changed",
                            "created_on": "2025-05-04T12:30:54.123456789Z",
                            "status": "archived"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND status = 'V'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-24c3-76f8-8228-9728778b6c98",
                "OrgID": 1,
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:30:54.123456789Z",
                    "status": "archived",
                    "type": "contact_status_changed"
                }
            }
        ]
    },
    {
        "label": "set status to active",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "status",
                    "status": "active"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-2c93-76f8-8f41-6b2d9f33d623",
                            "type": "contact_status_changed",
                            "created_on": "2025-05-04T12:30:56.123456789Z",
                            "status": "active"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND status = 'A'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-2c93-76f8-8f41-6b2d9f33d623",
                "OrgID": 1,
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:30:56.123456789Z",
                    "status": "active",
                    "type": "contact_status_changed"
                }
            }
        ]
    },
    {
        "label": "set text field with valid value",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "field",
                    "field": {
                        "key": "gender",
                        "name": "Gender"
                    },
                    "value": "M"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "fields": {
                            "gender": {
                                "text": "M"
                            }
                        }
                    },
                    "events": [
                        {
                            "uuid": "01969b47-384b-76f8-a17e-f85e49829fb9",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:30:59.123456789Z",
                            "field": {
                                "key": "gender",
                                "name": "Gender"
                            },
                            "value": {
                                "text": "M"
                            }
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND fields = '{\"3a5891e4-756e-4dc9-8e12-b7a766168824\": {\"text\": \"M\"}}'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-384b-76f8-a17e-f85e49829fb9",
                "OrgID": 1,
                "TTL": "2026-05-04T12:30:59Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:30:59.123456789Z",
                    "field": {
                        "key": "gender",
                        "name": "Gender"
                    },
                    "type": "contact_field_changed",
                    "value": {
                        "text": "M"
                    }
                }
            }
        ]
    },
    {
        "label": "set numeric field with valid value",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "field",
                    "field": {
                        "key": "age",
                        "name": "Age"
                    },
                    "value": "24"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "groups": [
                            {
                                "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                                "name": "Doctors"
                            }
                        ],
                        "fields": {
                            "age": {
                                "text": "24",
                                "number": 24
                            },
                            "gender": {
                                "text": "M"
                            }
                        }
                    },
                    "events": [
                        {
                            "uuid": "01969b47-4403-76f8-ba00-bd7f0d08e671",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:02.123456789Z",
                            "field": {
                                "key": "age",
                                "name": "Age"
                            },
                            "value": {
                                "text": "24",
                                "number": 24
                            }
                        },
                        {
                            "uuid": "01969b47-4bd3-76f8-b86e-4b881f09a186",
                            "type": "contact_groups_changed",
                            "created_on": "2025-05-04T12:31:04.123456789Z",
                            "groups_added": [
                                {
                                    "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                                    "name": "Doctors"
                                }
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND fields = '{\"3a5891e4-756e-4dc9-8e12-b7a766168824\": {\"text\": \"M\"}, \"903f51da-2717-47c7-a0d3-f2f32877013d\": {\"text\": \"24\", \"number\": 24}}'",
                "returns": 1
            },
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10000",
                "returns": 1
            },
            {
                "query": "SELECT count(*) FROM contacts_contactfire WHERE contact_id = 10000 AND fire_type = 'C'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-4403-76f8-ba00-bd7f0d08e671",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:02Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:02.123456789Z",
                    "field": {
                        "key": "age",
                        "name": "Age"
                    },
                    "type": "contact_field_changed",
                    "value": {
                        "number": 24,
                        "text": "24"
                    }
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-4bd3-76f8-b86e-4b881f09a186",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:04Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:04.123456789Z",
                    "groups_added": [
                        {
                            "name": "Doctors",
                            "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638"
                        }
                    ],
                    "type": "contact_groups_changed"
                }
            }
        ]
    },
    {
        "label": "set date field with valid value",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "field",
                    "field": {
                        "key": "joined",
                        "name": "Joined"
                    },
                    "value": "26/06/2020"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "groups": [
                            {
                                "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                                "name": "Doctors"
                            }
                        ],
                        "fields": {
                            "age": {
                                "text": "24",
                                "number": 24
                            },
                            "gender": {
                                "text": "M"
                            },
                            "joined": {
                                "text": "26/06/2020",
                                "datetime": "2020-06-26T05:31:06.123456-07:00"
                            }
                        }
                    },
                    "events": [
                        {
                            "uuid": "01969b47-5b73-76f8-a691-235cbe720980",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:08.123456789Z",
                            "field": {
                                "key": "joined",
                                "name": "Joined"
                            },
                            "value": {
                                "text": "26/06/2020",
                                "datetime": "2020-06-26T05:31:06.123456-07:00"
                            }
                        }
                    ]
                }
            },
            "skipped": []
        },
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-5b73-76f8-a691-235cbe720980",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:08Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:08.123456789Z",
                    "field": {
                        "key": "joined",
                        "name": "Joined"
                    },
                    "type": "contact_field_changed",
                    "value": {
                        "datetime": "2020-06-26T05:31:06.123456-07:00",
                        "text": "26/06/2020"
                    }
                }
            }
        ]
    },
    {
        "label": "set state field with valid value",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "field",
                    "field": {
                        "key": "state",
                        "name": "State"
                    },
                    "value": "BORNO"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "groups": [
                            {
                                "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                                "name": "Doctors"
                            }
                        ],
                        "fields": {
                            "age": {
                                "text": "24",
                                "number": 24
                            },
                            "gender": {
                                "text": "M"
                            },
                            "joined": {
                                "text": "26/06/2020",
                                "datetime": "2020-06-26T05:31:06.123456-07:00"
                            },
                            "state": {
                                "text": "BORNO",
                                "state": "Nigeria > Borno"
                            }
                        }
                    },
                    "events": [
                        {
                            "uuid": "01969b47-672b-76f8-bebe-b4a1f677cf4c",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:11.123456789Z",
                            "field": {
                                "key": "state",
                                "name": "State"
                            },
                            "value": {
                                "text": "BORNO",
                                "state": "Nigeria > Borno"
                            }
                        }
                    ]
                }
            },
            "skipped": []
        },
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-672b-76f8-bebe-b4a1f677cf4c",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:11Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:11.123456789Z",
                    "field": {
                        "key": "state",
                        "name": "State"
                    },
                    "type": "contact_field_changed",
                    "value": {
                        "state": "Nigeria \u003e Borno",
                        "text": "BORNO"
                    }
                }
            }
        ]
    },
    {
        "label": "clear fields",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "field",
                    "field": {
                        "key": "gender",
                        "name": "Gender"
                    },
                    "value": ""
                },
                {
                    "type": "field",
                    "field": {
                        "key": "age",
                        "name": "Age"
                    },
                    "value": ""
                },
                {
                    "type": "field",
                    "field": {
                        "key": "joined",
                        "name": "Joined"
                    },
                    "value": ""
                },
                {
                    "type": "field",
                    "field": {
                        "key": "state",
                        "name": "State"
                    },
                    "value": ""
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-6efb-76f8-8dbf-00ecf5d03034",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:13.123456789Z",
                            "field": {
                                "key": "gender",
                                "name": "Gender"
                            },
                            "value": null
                        },
                        {
                            "uuid": "01969b47-76cb-76f8-acca-bbca70987315",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:15.123456789Z",
                            "field": {
                                "key": "age",
                                "name": "Age"
                            },
                            "value": null
                        },
                        {
                            "uuid": "01969b47-7e9b-76f8-afcb-91a2073e5459",
                            "type": "contact_groups_changed",
                            "created_on": "2025-05-04T12:31:17.123456789Z",
                            "groups_removed": [
                                {
                                    "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638",
                                    "name": "Doctors"
                                }
                            ]
                        },
                        {
                            "uuid": "01969b47-866b-76f8-9654-8a7258fbaae4",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:19.123456789Z",
                            "field": {
                                "key": "joined",
                                "name": "Joined"
                            },
                            "value": null
                        },
                        {
                            "uuid": "01969b47-8e3b-76f8-8e78-3bde7b3370ae",
                            "type": "contact_field_changed",
                            "created_on": "2025-05-04T12:31:21.123456789Z",
                            "field": {
                                "key": "state",
                                "name": "State"
                            },
                            "value": null
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE id = 10000 AND fields = '{}'",
                "returns": 1
            },
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10005",
                "returns": 0
            },
            {
                "query": "SELECT count(*) FROM contacts_contactfire WHERE contact_id = 10000 AND fire_type = 'C'",
                "returns": 0
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-6efb-76f8-8dbf-00ecf5d03034",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:13Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:13.123456789Z",
                    "field": {
                        "key": "gender",
                        "name": "Gender"
                    },
                    "type": "contact_field_changed",
                    "value": null
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-76cb-76f8-acca-bbca70987315",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:15Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:15.123456789Z",
                    "field": {
                        "key": "age",
                        "name": "Age"
                    },
                    "type": "contact_field_changed",
                    "value": null
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-7e9b-76f8-afcb-91a2073e5459",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:17Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:17.123456789Z",
                    "groups_removed": [
                        {
                            "name": "Doctors",
                            "uuid": "c153e265-f7c9-4539-9dbc-9b358714b638"
                        }
                    ],
                    "type": "contact_groups_changed"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-866b-76f8-9654-8a7258fbaae4",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:19Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:19.123456789Z",
                    "field": {
                        "key": "joined",
                        "name": "Joined"
                    },
                    "type": "contact_field_changed",
                    "value": null
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-8e3b-76f8-8e78-3bde7b3370ae",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:21Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:21.123456789Z",
                    "field": {
                        "key": "state",
                        "name": "State"
                    },
                    "type": "contact_field_changed",
                    "value": null
                }
            }
        ]
    },
    {
        "label": "add group",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "groups",
                    "modification": "add",
                    "groups": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "groups": [
                            {
                                "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                "name": "Testers"
                            }
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-960b-76f8-b62c-3c781ca3b5da",
                            "type": "contact_groups_changed",
                            "created_on": "2025-05-04T12:31:23.123456789Z",
                            "groups_added": [
                                {
                                    "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                    "name": "Testers"
                                }
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10006",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-960b-76f8-b62c-3c781ca3b5da",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:23Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:23.123456789Z",
                    "groups_added": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ],
                    "type": "contact_groups_changed"
                }
            }
        ]
    },
    {
        "label": "add group contact already in",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "groups",
                    "modification": "add",
                    "groups": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "groups": [
                            {
                                "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                "name": "Testers"
                            }
                        ]
                    },
                    "events": []
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10006",
                "returns": 1
            }
        ]
    },
    {
        "label": "remove group",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "groups",
                    "modification": "remove",
                    "groups": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-9ddb-76f8-af9c-ff2f1faac4db",
                            "type": "contact_groups_changed",
                            "created_on": "2025-05-04T12:31:25.123456789Z",
                            "groups_removed": [
                                {
                                    "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                    "name": "Testers"
                                }
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10006",
                "returns": 0
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-9ddb-76f8-af9c-ff2f1faac4db",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:25Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:25.123456789Z",
                    "groups_removed": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ],
                    "type": "contact_groups_changed"
                }
            }
        ]
    },
    {
        "label": "remove group contact isn't part of",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "groups",
                    "modification": "remove",
                    "groups": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": []
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contactgroup_contacts WHERE contact_id = 10000 AND contactgroup_id = 10005",
                "returns": 0
            }
        ]
    },
    {
        "label": "set contact language",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "language",
                    "language": "fra"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-a5ab-76f8-8d9f-e51d30290005",
                            "type": "contact_language_changed",
                            "created_on": "2025-05-04T12:31:27.123456789Z",
                            "language": "fra"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contact WHERE language = 'fra' and id = 10000",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-a5ab-76f8-8d9f-e51d30290005",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:27Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:27.123456789Z",
                    "language": "fra",
                    "type": "contact_language_changed"
                }
            }
        ]
    },
    {
        "label": "add URN",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "urns",
                    "modification": "append",
                    "urns": [
                        "tel:+255788555111"
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111"
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-ad7b-76f8-bec9-e032f4f9af5f",
                            "type": "contact_urns_changed",
                            "created_on": "2025-05-04T12:31:29.123456789Z",
                            "urns": [
                                "tel:+255788555111"
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555111'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-ad7b-76f8-bec9-e032f4f9af5f",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:29Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:29.123456789Z",
                    "type": "contact_urns_changed",
                    "urns": [
                        "tel:+255788555111"
                    ]
                }
            }
        ]
    },
    {
        "label": "add an invalid URN",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "urns",
                    "modification": "append",
                    "urns": [
                        "xyz:12345"
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111"
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-b54b-76f8-9853-0310d032b497",
                            "type": "error",
                            "created_on": "2025-05-04T12:31:31.123456789Z",
                            "text": "'xyz:12345' is not valid URN"
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE identity = 'xyz:12345'",
                "returns": 0
            }
        ]
    },
    {
        "label": "add URNs, one of which already exists",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "urns",
                    "modification": "append",
                    "urns": [
                        "tel:+255788555111",
                        "tel:+255788555222"
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111",
                            "tel:+255788555222"
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-bd1b-76f8-8ab7-4a517a86045c",
                            "type": "contact_urns_changed",
                            "created_on": "2025-05-04T12:31:33.123456789Z",
                            "urns": [
                                "tel:+255788555111",
                                "tel:+255788555222"
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555111'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-bd1b-76f8-8ab7-4a517a86045c",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:33Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:33.123456789Z",
                    "type": "contact_urns_changed",
                    "urns": [
                        "tel:+255788555111",
                        "tel:+255788555222"
                    ]
                }
            }
        ]
    },
    {
        "label": "remove a URN",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "urns",
                    "modification": "remove",
                    "urns": [
                        "tel:+255788555222"
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111"
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-c4eb-76f8-97a3-ae27459a6be4",
                            "type": "contact_urns_changed",
                            "created_on": "2025-05-04T12:31:35.123456789Z",
                            "urns": [
                                "tel:+255788555111"
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555111'",
                "returns": 1
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555222'",
                "returns": 0
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-c4eb-76f8-97a3-ae27459a6be4",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:35Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:35.123456789Z",
                    "type": "contact_urns_changed",
                    "urns": [
                        "tel:+255788555111"
                    ]
                }
            }
        ]
    },
    {
        "label": "set URNs",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "urns",
                    "modification": "set",
                    "urns": [
                        "tel:+255788555111",
                        "tel:+255788555333"
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111",
                            "tel:+255788555333"
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-ccbb-76f8-ba82-c15b24dd577f",
                            "type": "contact_urns_changed",
                            "created_on": "2025-05-04T12:31:37.123456789Z",
                            "urns": [
                                "tel:+255788555111",
                                "tel:+255788555333"
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(DISTINCT path) FROM contacts_contacturn WHERE path IN ('+255788555111', '+255788555222', '+255788555333')",
                "returns": 3
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555111'",
                "returns": 1
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555222'",
                "returns": 0
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555333'",
                "returns": 1
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-ccbb-76f8-ba82-c15b24dd577f",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:37Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:37.123456789Z",
                    "type": "contact_urns_changed",
                    "urns": [
                        "tel:+255788555111",
                        "tel:+255788555333"
                    ]
                }
            }
        ]
    },
    {
        "label": "clear URNs",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "urns",
                    "modification": "set",
                    "urns": []
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z"
                    },
                    "events": [
                        {
                            "uuid": "01969b47-d48b-76f8-ba7e-53c2263e32f8",
                            "type": "contact_urns_changed",
                            "created_on": "2025-05-04T12:31:39.123456789Z",
                            "urns": []
                        }
                    ]
                }
            },
            "skipped": []
        },
        "db_assertions": [
            {
                "query": "SELECT count(DISTINCT path) FROM contacts_contacturn WHERE path IN ('+255788555111', '+255788555222', '+255788555333')",
                "returns": 3
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555111'",
                "returns": 0
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555222'",
                "returns": 0
            },
            {
                "query": "SELECT count(*) FROM contacts_contacturn WHERE contact_id = 10000 AND path = '+255788555333'",
                "returns": 0
            }
        ],
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-d48b-76f8-ba7e-53c2263e32f8",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:39Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:39.123456789Z",
                    "type": "contact_urns_changed",
                    "urns": []
                }
            }
        ]
    },
    {
        "label": "open ticket",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "ticket",
                    "topic": {
                        "uuid": "0a8f2e00-fef6-402c-bd79-d789446ec0e0",
                        "name": "Support"
                    },
                    "note": "Need help",
                    "assignee": {
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25",
                        "name": "Andy Admin"
                    }
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "language": "fra",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "groups": [
                            {
                                "uuid": "361838c4-2866-495a-8990-9f3c222a7604",
                                "name": "Open Tickets"
                            }
                        ],
                        "tickets": [
                            {
                                "uuid": "01969b47-dc5b-76f8-aaa3-04d3fbce5f9a",
                                "status": "open",
                                "topic": {
                                    "uuid": "0a8f2e00-fef6-402c-bd79-d789446ec0e0",
                                    "name": "Support"
                                },
                                "assignee": {
                                    "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25",
                                    "name": "Andy Admin"
                                }
                            }
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-e043-76f8-a13f-9238de2a0b76",
                            "type": "ticket_opened",
                            "created_on": "2025-05-04T12:31:42.123456789Z",
                            "ticket": {
                                "uuid": "01969b47-dc5b-76f8-aaa3-04d3fbce5f9a",
                                "status": "open",
                                "topic": {
                                    "uuid": "0a8f2e00-fef6-402c-bd79-d789446ec0e0",
                                    "name": "Support"
                                },
                                "assignee": {
                                    "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25",
                                    "name": "Andy Admin"
                                }
                            },
                            "note": "Need help"
                        },
                        {
                            "uuid": "01969b47-e813-76f8-9014-2c868db4022e",
                            "type": "contact_groups_changed",
                            "created_on": "2025-05-04T12:31:44.123456789Z",
                            "groups_added": [
                                {
                                    "uuid": "361838c4-2866-495a-8990-9f3c222a7604",
                                    "name": "Open Tickets"
                                }
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-e043-76f8-a13f-9238de2a0b76",
                "OrgID": 1,
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:42.123456789Z",
                    "note": "Need help",
                    "ticket": {
                        "assignee": {
                            "name": "Andy Admin",
                            "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                        },
                        "status": "open",
                        "topic": {
                            "name": "Support",
                            "uuid": "0a8f2e00-fef6-402c-bd79-d789446ec0e0"
                        },
                        "uuid": "01969b47-dc5b-76f8-aaa3-04d3fbce5f9a"
                    },
                    "type": "ticket_opened"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-e813-76f8-9014-2c868db4022e",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:44Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:44.123456789Z",
                    "groups_added": [
                        {
                            "name": "Open Tickets",
                            "uuid": "361838c4-2866-495a-8990-9f3c222a7604"
                        }
                    ],
                    "type": "contact_groups_changed"
                }
            }
        ]
    },
    {
        "label": "multiple modifiers of different types",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000
            ],
            "modifiers": [
                {
                    "type": "name",
                    "name": "Juan"
                },
                {
                    "type": "language",
                    "language": "spa"
                },
                {
                    "type": "groups",
                    "modification": "add",
                    "groups": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ]
                },
                {
                    "type": "urns",
                    "modification": "set",
                    "urns": [
                        "tel:+255788555111"
                    ]
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "name": "Juan",
                        "language": "spa",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111"
                        ],
                        "groups": [
                            {
                                "uuid": "361838c4-2866-495a-8990-9f3c222a7604",
                                "name": "Open Tickets"
                            },
                            {
                                "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                "name": "Testers"
                            }
                        ],
                        "tickets": [
                            {
                                "uuid": "01969b47-dc5b-76f8-aaa3-04d3fbce5f9a",
                                "status": "open",
                                "topic": {
                                    "uuid": "0a8f2e00-fef6-402c-bd79-d789446ec0e0",
                                    "name": "Support"
                                },
                                "assignee": {
                                    "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25",
                                    "name": "Andy Admin"
                                }
                            }
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b47-f3cb-76f8-bef6-3979f99a96f9",
                            "type": "contact_name_changed",
                            "created_on": "2025-05-04T12:31:47.123456789Z",
                            "name": "Juan"
                        },
                        {
                            "uuid": "01969b47-fb9b-76f8-ba91-c48ad8c50e6b",
                            "type": "contact_language_changed",
                            "created_on": "2025-05-04T12:31:49.123456789Z",
                            "language": "spa"
                        },
                        {
                            "uuid": "01969b48-036b-76f8-be24-6164105d48f2",
                            "type": "contact_groups_changed",
                            "created_on": "2025-05-04T12:31:51.123456789Z",
                            "groups_added": [
                                {
                                    "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                    "name": "Testers"
                                }
                            ]
                        },
                        {
                            "uuid": "01969b48-0b3b-76f8-8768-7d0ba4d4f3e8",
                            "type": "contact_urns_changed",
                            "created_on": "2025-05-04T12:31:53.123456789Z",
                            "urns": [
                                "tel:+255788555111"
                            ]
                        }
                    ]
                }
            },
            "skipped": []
        },
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-f3cb-76f8-bef6-3979f99a96f9",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:47Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:47.123456789Z",
                    "name": "Juan",
                    "type": "contact_name_changed"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b47-fb9b-76f8-ba91-c48ad8c50e6b",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:49Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:49.123456789Z",
                    "language": "spa",
                    "type": "contact_language_changed"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b48-036b-76f8-be24-6164105d48f2",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:51Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:51.123456789Z",
                    "groups_added": [
                        {
                            "name": "Testers",
                            "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d"
                        }
                    ],
                    "type": "contact_groups_changed"
                }
            },
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b48-0b3b-76f8-8768-7d0ba4d4f3e8",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:53Z",
                "Data": {
                    "created_on": "2025-05-04T12:31:53.123456789Z",
                    "type": "contact_urns_changed",
                    "urns": [
                        "tel:+255788555111"
                    ]
                }
            }
        ]
    },
    {
        "label": "locked contacts are skipped",
        "method": "POST",
        "path": "/mi/contact/modify",
        "body": {
            "org_id": 1,
            "user_id": 3,
            "contact_ids": [
                10000,
                10003
            ],
            "modifiers": [
                {
                    "type": "language",
                    "language": "eng"
                }
            ]
        },
        "status": 200,
        "response": {
            "modified": {
                "10000": {
                    "contact": {
                        "uuid": "a393abc0-283d-4c9b-a1b3-641a035c34bf",
                        "id": 10000,
                        "name": "Juan",
                        "language": "eng",
                        "status": "active",
                        "timezone": "America/Los_Angeles",
                        "created_on": "2018-07-06T12:30:00.123457Z",
                        "urns": [
                            "tel:+255788555111"
                        ],
                        "groups": [
                            {
                                "uuid": "361838c4-2866-495a-8990-9f3c222a7604",
                                "name": "Open Tickets"
                            },
                            {
                                "uuid": "5e9d8fab-5e7e-4f51-b533-261af5dea70d",
                                "name": "Testers"
                            }
                        ],
                        "tickets": [
                            {
                                "uuid": "01969b47-dc5b-76f8-aaa3-04d3fbce5f9a",
                                "status": "open",
                                "topic": {
                                    "uuid": "0a8f2e00-fef6-402c-bd79-d789446ec0e0",
                                    "name": "Support"
                                },
                                "assignee": {
                                    "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25",
                                    "name": "Andy Admin"
                                }
                            }
                        ]
                    },
                    "events": [
                        {
                            "uuid": "01969b48-130b-76f8-b63d-c8dcc2fa9de0",
                            "type": "contact_language_changed",
                            "created_on": "2025-05-04T12:31:55.123456789Z",
                            "language": "eng"
                        }
                    ]
                }
            },
            "skipped": [
                10003
            ]
        },
        "expected_history": [
            {
                "PK": "con#a393abc0-283d-4c9b-a1b3-641a035c34bf",
                "SK": "evt#01969b48-130b-76f8-b63d-c8dcc2fa9de0",
                "OrgID": 1,
                "TTL": "2026-05-04T12:31:55Z",
                "Data": {
                    "_user": {
                        "name": "Andy Admin",
                        "uuid": "e29fdf9f-56ab-422a-b77d-e3ec26091a25"
                    },
                    "created_on": "2025-05-04T12:31:55.123456789Z",
                    "language": "eng",
                    "type": "contact_language_changed"
                }
            }
        ]
    }
]